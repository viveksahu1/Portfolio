'use strict';

const kit = require('@nuxt/kit');
const constant = require('@oku-ui/primitives/constant');

const index = kit.defineNuxtModule({
  meta: {
    name: "@oku-ui/nuxt",
    configKey: "primitives",
    compatibility: {
      nuxt: ">=3.14"
    }
  },
  defaults: {
    prefix: "",
    components: true
  },
  setup(options) {
    function getComponents() {
      if (typeof options.components === "object") {
        return Object.entries(constant.components).filter(([name]) => options.components[name]).flatMap(([_, components]) => components);
      }
      if (options.components)
        return Object.values(constant.components).flat();
      return [];
    }
    for (const component of getComponents()) {
      kit.addComponent({
        name: `${options.prefix}${component}`,
        export: component,
        filePath: "@oku-ui/primitives"
      });
    }
  }
});

module.exports = index;
